import{S as tl,i as sl,s as al,I as je,y as be,z as me,A as ge,J as rt,K as nt,g as O,d as F,B as ke,L as ll,M as it,N as ut,O as ct,P as ft,k as h,l as _,m as d,h as f,n as u,a1 as Tt,b as te,E as o,v as qe,f as He,H as jl,a2 as Qt,a0 as Yt,q as M,a as C,r as U,c as N,U as Wt,X as $,_ as yl,F as W,u as Ge,G as Ne,$ as ht,Y as Sl,C as _e,D as de,o as xt,Z as es,w as il,a3 as ul,a4 as cl,e as Pt,T as Dt,a5 as ls}from"../chunks/index.d08effdb.js";import{S as ts}from"../chunks/simpleLoader.fc6986a4.js";import{u as ss,a as as,f as Mt,d as os}from"../chunks/db_functions.f650cbce.js";import{b as ot,P as rs}from"../chunks/libStore.f2bdde06.js";import{k as Ve,s as ns,m as Ut,u as is}from"../chunks/authStore.3bb8eab3.js";import{I as _t}from"../chunks/Icon.4dc19c6d.js";function us(r){let e;const l=r[2].default,a=it(l,r,r[3],null);return{c(){a&&a.c()},l(s){a&&a.l(s)},m(s,t){a&&a.m(s,t),e=!0},p(s,t){a&&a.p&&(!e||t&8)&&ut(a,l,s,s[3],e?ft(l,s[3],t,null):ct(s[3]),null)},i(s){e||(O(a,s),e=!0)},o(s){F(a,s),e=!1},d(s){a&&a.d(s)}}}function cs(r){let e,l;const a=[{name:"book-open"},r[1],{iconNode:r[0]}];let s={$$slots:{default:[us]},$$scope:{ctx:r}};for(let t=0;t<a.length;t+=1)s=je(s,a[t]);return e=new _t({props:s}),{c(){be(e.$$.fragment)},l(t){me(e.$$.fragment,t)},m(t,i){ge(e,t,i),l=!0},p(t,[i]){const c=i&3?rt(a,[a[0],i&2&&nt(t[1]),i&1&&{iconNode:t[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:t}),e.$set(c)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function fs(r,e,l){let{$$slots:a={},$$scope:s}=e;const t=[["path",{d:"M12 7v14"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}]];return r.$$set=i=>{l(1,e=je(je({},e),ll(i))),"$$scope"in i&&l(3,s=i.$$scope)},e=ll(e),[t,e,a,s]}class hs extends tl{constructor(e){super(),sl(this,e,fs,cs,al,{})}}const _s=hs;function ds(r){let e;const l=r[2].default,a=it(l,r,r[3],null);return{c(){a&&a.c()},l(s){a&&a.l(s)},m(s,t){a&&a.m(s,t),e=!0},p(s,t){a&&a.p&&(!e||t&8)&&ut(a,l,s,s[3],e?ft(l,s[3],t,null):ct(s[3]),null)},i(s){e||(O(a,s),e=!0)},o(s){F(a,s),e=!1},d(s){a&&a.d(s)}}}function ps(r){let e,l;const a=[{name:"bookmark"},r[1],{iconNode:r[0]}];let s={$$slots:{default:[ds]},$$scope:{ctx:r}};for(let t=0;t<a.length;t+=1)s=je(s,a[t]);return e=new _t({props:s}),{c(){be(e.$$.fragment)},l(t){me(e.$$.fragment,t)},m(t,i){ge(e,t,i),l=!0},p(t,[i]){const c=i&3?rt(a,[a[0],i&2&&nt(t[1]),i&1&&{iconNode:t[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:t}),e.$set(c)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function vs(r,e,l){let{$$slots:a={},$$scope:s}=e;const t=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"}]];return r.$$set=i=>{l(1,e=je(je({},e),ll(i))),"$$scope"in i&&l(3,s=i.$$scope)},e=ll(e),[t,e,a,s]}class bs extends tl{constructor(e){super(),sl(this,e,vs,ps,al,{})}}const $t=bs;function ms(r){let e;const l=r[2].default,a=it(l,r,r[3],null);return{c(){a&&a.c()},l(s){a&&a.l(s)},m(s,t){a&&a.m(s,t),e=!0},p(s,t){a&&a.p&&(!e||t&8)&&ut(a,l,s,s[3],e?ft(l,s[3],t,null):ct(s[3]),null)},i(s){e||(O(a,s),e=!0)},o(s){F(a,s),e=!1},d(s){a&&a.d(s)}}}function gs(r){let e,l;const a=[{name:"search"},r[1],{iconNode:r[0]}];let s={$$slots:{default:[ms]},$$scope:{ctx:r}};for(let t=0;t<a.length;t+=1)s=je(s,a[t]);return e=new _t({props:s}),{c(){be(e.$$.fragment)},l(t){me(e.$$.fragment,t)},m(t,i){ge(e,t,i),l=!0},p(t,[i]){const c=i&3?rt(a,[a[0],i&2&&nt(t[1]),i&1&&{iconNode:t[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:t}),e.$set(c)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function ks(r,e,l){let{$$slots:a={},$$scope:s}=e;const t=[["circle",{cx:"11",cy:"11",r:"8"}],["path",{d:"m21 21-4.3-4.3"}]];return r.$$set=i=>{l(1,e=je(je({},e),ll(i))),"$$scope"in i&&l(3,s=i.$$scope)},e=ll(e),[t,e,a,s]}class Ls extends tl{constructor(e){super(),sl(this,e,ks,gs,al,{})}}const Es=Ls;function Vt(r,e,l){const a=r.slice();return a[30]=e[l],a}function Cs(r){let e,l,a,s,t,i,c,n,b,p,k,m,L,g,Z=r[3]?"...":"Recupera dati",S,q,R,X,y,A,j,T,K,V,H,G,Y,ee,ne,v,P,I,z,ce,se,ae,E,D,J,x,le,oe,pe,ie,fe,ye,Fe,ue,Al,Ze,Xe,wl,Tl,Ie,Pl,Be,Oe,Je,Dl,Ml,he,Se,Ul,Vl,Zl,Ae,Ke,Ol,Rl,we,zl,Te,Qe,ql,Hl,Le,Gl,Pe,Ee,Ye,Fl,Xl,De,Jl,ol,Kl,Ce,We,Ql,Yl,Me,Wl,rl,$l,Ue,Re,xl,et,ze,lt,tt,dt,$e=[...r[1]],re=[];for(let B=0;B<$e.length;B+=1)re[B]=Zt(Vt(r,$e,B));function pt(B,Q){return B[5]?Bs:Is}let fl=pt(r),ve=fl(r);return{c(){e=h("h2"),l=M(r[7]),a=M(" libro"),s=C(),t=h("div"),i=h("div"),c=h("label"),n=h("span"),b=M("ISBN:"),p=C(),k=h("div"),m=h("input"),L=C(),g=h("button"),S=M(Z),q=C(),R=h("label"),X=h("span"),y=M("Titolo:"),A=C(),j=h("input"),T=C(),K=h("div"),V=h("span"),H=M("Autore:"),G=C(),Y=h("div"),ee=h("input"),ne=C(),v=h("input"),P=C(),I=h("label"),z=h("span"),ce=M("Editore:"),se=C(),ae=h("input"),E=C(),D=h("label"),J=h("span"),x=M("Luogo:"),le=C(),oe=h("input"),pe=C(),ie=h("label"),fe=h("span"),ye=M("Anno:"),Fe=C(),ue=h("input"),Al=C(),Ze=h("label"),Xe=h("span"),wl=M("Genere:"),Tl=C(),Ie=h("input"),Pl=C(),Be=h("div"),Oe=h("label"),Je=h("span"),Dl=M("Scaffale:"),Ml=C(),he=h("select"),Se=h("option"),Ul=M("Seleziona uno scaffale");for(let B=0;B<re.length;B+=1)re[B].c();Vl=C(),ve.c(),Zl=C(),Ae=h("label"),Ke=h("span"),Ol=M("Commenti:"),Rl=C(),we=h("textarea"),zl=C(),Te=h("label"),Qe=h("span"),ql=M("Copertina:"),Hl=C(),Le=h("input"),Gl=C(),Pe=h("div"),Ee=h("label"),Ye=h("span"),Fl=M("Letto:"),Xl=C(),De=h("input"),Jl=C(),ol=h("span"),Kl=C(),Ce=h("label"),We=h("span"),Ql=M("Prestito:"),Yl=C(),Me=h("input"),Wl=C(),rl=h("span"),$l=C(),Ue=h("div"),Re=h("button"),xl=M("Annulla"),et=C(),ze=h("button"),lt=M("Salva"),this.h()},l(B){e=_(B,"H2",{class:!0});var Q=d(e);l=U(Q,r[7]),a=U(Q," libro"),Q.forEach(f),s=N(B),t=_(B,"DIV",{class:!0});var w=d(t);i=_(w,"DIV",{class:!0});var nl=d(i);c=_(nl,"LABEL",{});var hl=d(c);n=_(hl,"SPAN",{class:!0});var vt=d(n);b=U(vt,"ISBN:"),vt.forEach(f),p=N(hl),k=_(hl,"DIV",{class:!0});var _l=d(k);m=_(_l,"INPUT",{type:!0,placeholder:!0,class:!0}),L=N(_l),g=_(_l,"BUTTON",{class:!0});var bt=d(g);S=U(bt,Z),bt.forEach(f),_l.forEach(f),hl.forEach(f),nl.forEach(f),q=N(w),R=_(w,"LABEL",{class:!0});var dl=d(R);X=_(dl,"SPAN",{class:!0});var mt=d(X);y=U(mt,"Titolo:"),mt.forEach(f),A=N(dl),j=_(dl,"INPUT",{type:!0,class:!0}),dl.forEach(f),T=N(w),K=_(w,"DIV",{class:!0});var pl=d(K);V=_(pl,"SPAN",{class:!0});var gt=d(V);H=U(gt,"Autore:"),gt.forEach(f),G=N(pl),Y=_(pl,"DIV",{class:!0});var vl=d(Y);ee=_(vl,"INPUT",{type:!0,placeholder:!0,class:!0}),ne=N(vl),v=_(vl,"INPUT",{type:!0,placeholder:!0,class:!0}),vl.forEach(f),pl.forEach(f),P=N(w),I=_(w,"LABEL",{});var bl=d(I);z=_(bl,"SPAN",{class:!0});var kt=d(z);ce=U(kt,"Editore:"),kt.forEach(f),se=N(bl),ae=_(bl,"INPUT",{type:!0,class:!0}),bl.forEach(f),E=N(w),D=_(w,"LABEL",{});var ml=d(D);J=_(ml,"SPAN",{class:!0});var Lt=d(J);x=U(Lt,"Luogo:"),Lt.forEach(f),le=N(ml),oe=_(ml,"INPUT",{type:!0,class:!0}),ml.forEach(f),pe=N(w),ie=_(w,"LABEL",{});var gl=d(ie);fe=_(gl,"SPAN",{class:!0});var Et=d(fe);ye=U(Et,"Anno:"),Et.forEach(f),Fe=N(gl),ue=_(gl,"INPUT",{type:!0,class:!0}),gl.forEach(f),Al=N(w),Ze=_(w,"LABEL",{});var kl=d(Ze);Xe=_(kl,"SPAN",{class:!0});var Ct=d(Xe);wl=U(Ct,"Genere:"),Ct.forEach(f),Tl=N(kl),Ie=_(kl,"INPUT",{type:!0,class:!0}),kl.forEach(f),Pl=N(w),Be=_(w,"DIV",{class:!0});var Ll=d(Be);Oe=_(Ll,"LABEL",{});var El=d(Oe);Je=_(El,"SPAN",{class:!0});var Nt=d(Je);Dl=U(Nt,"Scaffale:"),Nt.forEach(f),Ml=N(El),he=_(El,"SELECT",{class:!0});var st=d(he);Se=_(st,"OPTION",{});var It=d(Se);Ul=U(It,"Seleziona uno scaffale"),It.forEach(f);for(let at=0;at<re.length;at+=1)re[at].l(st);st.forEach(f),El.forEach(f),Vl=N(Ll),ve.l(Ll),Ll.forEach(f),Zl=N(w),Ae=_(w,"LABEL",{class:!0});var Cl=d(Ae);Ke=_(Cl,"SPAN",{class:!0});var Bt=d(Ke);Ol=U(Bt,"Commenti:"),Bt.forEach(f),Rl=N(Cl),we=_(Cl,"TEXTAREA",{class:!0}),d(we).forEach(f),Cl.forEach(f),zl=N(w),Te=_(w,"LABEL",{class:!0});var Nl=d(Te);Qe=_(Nl,"SPAN",{class:!0});var jt=d(Qe);ql=U(jt,"Copertina:"),jt.forEach(f),Hl=N(Nl),Le=_(Nl,"INPUT",{type:!0,placeholder:!0,class:!0}),Nl.forEach(f),Gl=N(w),Pe=_(w,"DIV",{class:!0});var Il=d(Pe);Ee=_(Il,"LABEL",{class:!0});var xe=d(Ee);Ye=_(xe,"SPAN",{class:!0});var yt=d(Ye);Fl=U(yt,"Letto:"),yt.forEach(f),Xl=N(xe),De=_(xe,"INPUT",{type:!0,class:!0}),Jl=N(xe),ol=_(xe,"SPAN",{class:!0}),d(ol).forEach(f),xe.forEach(f),Kl=N(Il),Ce=_(Il,"LABEL",{class:!0});var el=d(Ce);We=_(el,"SPAN",{class:!0});var St=d(We);Ql=U(St,"Prestito:"),St.forEach(f),Yl=N(el),Me=_(el,"INPUT",{type:!0,class:!0}),Wl=N(el),rl=_(el,"SPAN",{class:!0}),d(rl).forEach(f),el.forEach(f),Il.forEach(f),$l=N(w),Ue=_(w,"DIV",{class:!0});var Bl=d(Ue);Re=_(Bl,"BUTTON",{class:!0});var At=d(Re);xl=U(At,"Annulla"),At.forEach(f),et=N(Bl),ze=_(Bl,"BUTTON",{class:!0});var wt=d(ze);lt=U(wt,"Salva"),wt.forEach(f),Bl.forEach(f),w.forEach(f),this.h()},h(){u(e,"class","form-title svelte-5rjid1"),u(n,"class","label-text svelte-5rjid1"),u(m,"type","text"),u(m,"placeholder","Inserisci ISBN"),u(m,"class","svelte-5rjid1"),u(g,"class","fetch-btn svelte-5rjid1"),g.disabled=ys,u(k,"class","isbn-input svelte-5rjid1"),u(i,"class","isbn-section full-width svelte-5rjid1"),u(X,"class","label-text svelte-5rjid1"),u(j,"type","text"),j.required=!0,u(j,"class","svelte-5rjid1"),u(R,"class","full-width svelte-5rjid1"),u(V,"class","label-text svelte-5rjid1"),u(ee,"type","text"),u(ee,"placeholder","Nome"),u(ee,"class","svelte-5rjid1"),u(v,"type","text"),u(v,"placeholder","Cognome"),u(v,"class","svelte-5rjid1"),u(Y,"class","author-inputs svelte-5rjid1"),u(K,"class","author-group full-width svelte-5rjid1"),u(z,"class","label-text svelte-5rjid1"),u(ae,"type","text"),u(ae,"class","svelte-5rjid1"),u(J,"class","label-text svelte-5rjid1"),u(oe,"type","text"),u(oe,"class","svelte-5rjid1"),u(fe,"class","label-text svelte-5rjid1"),u(ue,"type","number"),u(ue,"class","svelte-5rjid1"),u(Xe,"class","label-text svelte-5rjid1"),u(Ie,"type","text"),u(Ie,"class","svelte-5rjid1"),u(Je,"class","label-text svelte-5rjid1"),Se.__value="",Se.value=Se.__value,u(he,"class","svelte-5rjid1"),r[2].bookshelf===void 0&&Wt(()=>r[22].call(he)),u(Be,"class","bookshelf-section full-width svelte-5rjid1"),u(Ke,"class","label-text svelte-5rjid1"),u(we,"class","svelte-5rjid1"),u(Ae,"class","full-width svelte-5rjid1"),u(Qe,"class","label-text svelte-5rjid1"),u(Le,"type","text"),u(Le,"placeholder","Incolla il link dell'immagine di copertina"),u(Le,"class","svelte-5rjid1"),u(Te,"class","full-width svelte-5rjid1"),u(Ye,"class","label-text svelte-5rjid1"),u(De,"type","checkbox"),u(De,"class","svelte-5rjid1"),u(ol,"class","checkmark"),u(Ee,"class","toggle svelte-5rjid1"),u(We,"class","label-text svelte-5rjid1"),u(Me,"type","checkbox"),u(Me,"class","svelte-5rjid1"),u(rl,"class","checkmark"),u(Ce,"class","toggle svelte-5rjid1"),u(Pe,"class","toggles-group full-width svelte-5rjid1"),u(Re,"class","discard svelte-5rjid1"),u(ze,"class","save svelte-5rjid1"),u(Ue,"class","buttons full-width svelte-5rjid1"),u(t,"class","form-grid svelte-5rjid1")},m(B,Q){te(B,e,Q),o(e,l),o(e,a),te(B,s,Q),te(B,t,Q),o(t,i),o(i,c),o(c,n),o(n,b),o(c,p),o(c,k),o(k,m),$(m,r[2].isbn),o(k,L),o(k,g),o(g,S),o(t,q),o(t,R),o(R,X),o(X,y),o(R,A),o(R,j),$(j,r[2].title),o(t,T),o(t,K),o(K,V),o(V,H),o(K,G),o(K,Y),o(Y,ee),$(ee,r[2].authorName),o(Y,ne),o(Y,v),$(v,r[2].authorSurname),o(t,P),o(t,I),o(I,z),o(z,ce),o(I,se),o(I,ae),$(ae,r[2].editor),o(t,E),o(t,D),o(D,J),o(J,x),o(D,le),o(D,oe),$(oe,r[2].place),o(t,pe),o(t,ie),o(ie,fe),o(fe,ye),o(ie,Fe),o(ie,ue),$(ue,r[2].year),o(t,Al),o(t,Ze),o(Ze,Xe),o(Xe,wl),o(Ze,Tl),o(Ze,Ie),$(Ie,r[2].genre),o(t,Pl),o(t,Be),o(Be,Oe),o(Oe,Je),o(Je,Dl),o(Oe,Ml),o(Oe,he),o(he,Se),o(Se,Ul);for(let w=0;w<re.length;w+=1)re[w]&&re[w].m(he,null);yl(he,r[2].bookshelf,!0),o(Be,Vl),ve.m(Be,null),o(t,Zl),o(t,Ae),o(Ae,Ke),o(Ke,Ol),o(Ae,Rl),o(Ae,we),$(we,r[2].comments),o(t,zl),o(t,Te),o(Te,Qe),o(Qe,ql),o(Te,Hl),o(Te,Le),$(Le,r[2].cover),o(t,Gl),o(t,Pe),o(Pe,Ee),o(Ee,Ye),o(Ye,Fl),o(Ee,Xl),o(Ee,De),De.checked=r[2].read,o(Ee,Jl),o(Ee,ol),o(Pe,Kl),o(Pe,Ce),o(Ce,We),o(We,Ql),o(Ce,Yl),o(Ce,Me),Me.checked=r[2].loaned,o(Ce,Wl),o(Ce,rl),o(t,$l),o(t,Ue),o(Ue,Re),o(Re,xl),o(Ue,et),o(Ue,ze),o(ze,lt),tt||(dt=[W(m,"input",r[14]),W(g,"click",r[9]),W(j,"input",r[15]),W(ee,"input",r[16]),W(v,"input",r[17]),W(ae,"input",r[18]),W(oe,"input",r[19]),W(ue,"input",r[20]),W(Ie,"input",r[21]),W(he,"change",r[22]),W(we,"input",r[25]),W(Le,"input",r[26]),W(De,"change",r[27]),W(Me,"change",r[28]),W(Re,"click",r[11]),W(ze,"click",r[10])],tt=!0)},p(B,Q){if(Q[0]&6&&m.value!==B[2].isbn&&$(m,B[2].isbn),Q[0]&8&&Z!==(Z=B[3]?"...":"Recupera dati")&&Ge(S,Z),Q[0]&6&&j.value!==B[2].title&&$(j,B[2].title),Q[0]&6&&ee.value!==B[2].authorName&&$(ee,B[2].authorName),Q[0]&6&&v.value!==B[2].authorSurname&&$(v,B[2].authorSurname),Q[0]&6&&ae.value!==B[2].editor&&$(ae,B[2].editor),Q[0]&6&&oe.value!==B[2].place&&$(oe,B[2].place),Q[0]&6&&Qt(ue.value)!==B[2].year&&$(ue,B[2].year),Q[0]&6&&Ie.value!==B[2].genre&&$(Ie,B[2].genre),Q[0]&2){$e=[...B[1]];let w;for(w=0;w<$e.length;w+=1){const nl=Vt(B,$e,w);re[w]?re[w].p(nl,Q):(re[w]=Zt(nl),re[w].c(),re[w].m(he,null))}for(;w<re.length;w+=1)re[w].d(1);re.length=$e.length}Q[0]&6&&yl(he,B[2].bookshelf),fl===(fl=pt(B))&&ve?ve.p(B,Q):(ve.d(1),ve=fl(B),ve&&(ve.c(),ve.m(Be,null))),Q[0]&6&&$(we,B[2].comments),Q[0]&6&&Le.value!==B[2].cover&&$(Le,B[2].cover),Q[0]&6&&(De.checked=B[2].read),Q[0]&6&&(Me.checked=B[2].loaned)},i:Ne,o:Ne,d(B){B&&f(e),B&&f(s),B&&f(t),ht(re,B),ve.d(),tt=!1,Sl(dt)}}}function Ns(r){let e,l,a,s,t,i,c,n,b;return l=new ts({}),{c(){e=h("div"),be(l.$$.fragment),a=C(),s=h("div"),t=h("button"),i=M("Annulla"),this.h()},l(p){e=_(p,"DIV",{class:!0});var k=d(e);me(l.$$.fragment,k),a=N(k),s=_(k,"DIV",{class:!0});var m=d(s);t=_(m,"BUTTON",{class:!0});var L=d(t);i=U(L,"Annulla"),L.forEach(f),m.forEach(f),k.forEach(f),this.h()},h(){u(t,"class","discard svelte-5rjid1"),u(s,"class","buttons svelte-5rjid1"),u(e,"class","loader svelte-5rjid1")},m(p,k){te(p,e,k),ge(l,e,null),o(e,a),o(e,s),o(s,t),o(t,i),c=!0,n||(b=W(t,"click",r[11]),n=!0)},p:Ne,i(p){c||(O(l.$$.fragment,p),c=!0)},o(p){F(l.$$.fragment,p),c=!1},d(p){p&&f(e),ke(l),n=!1,b()}}}function Zt(r){let e,l=r[30]+"",a,s;return{c(){e=h("option"),a=M(l),this.h()},l(t){e=_(t,"OPTION",{});var i=d(e);a=U(i,l),i.forEach(f),this.h()},h(){e.__value=s=r[30],e.value=e.__value},m(t,i){te(t,e,i),o(e,a)},p(t,i){i[0]&2&&l!==(l=t[30]+"")&&Ge(a,l),i[0]&2&&s!==(s=t[30])&&(e.__value=s,e.value=e.__value)},d(t){t&&f(e)}}}function Is(r){let e,l,a,s;return{c(){e=h("button"),l=M("Nuovo scaffale"),this.h()},l(t){e=_(t,"BUTTON",{class:!0});var i=d(e);l=U(i,"Nuovo scaffale"),i.forEach(f),this.h()},h(){u(e,"class","new-shelf svelte-5rjid1")},m(t,i){te(t,e,i),o(e,l),a||(s=W(e,"click",r[24]),a=!0)},p:Ne,d(t){t&&f(e),a=!1,s()}}}function Bs(r){let e,l,a,s,t,i,c;return{c(){e=h("div"),l=h("input"),a=C(),s=h("button"),t=M("Aggiungi"),this.h()},l(n){e=_(n,"DIV",{class:!0});var b=d(e);l=_(b,"INPUT",{type:!0,placeholder:!0,class:!0}),a=N(b),s=_(b,"BUTTON",{class:!0});var p=d(s);t=U(p,"Aggiungi"),p.forEach(f),b.forEach(f),this.h()},h(){u(l,"type","text"),u(l,"placeholder","Nome nuovo scaffale"),u(l,"class","svelte-5rjid1"),u(s,"class","add-shelf svelte-5rjid1"),u(e,"class","new-bookshelf-input svelte-5rjid1")},m(n,b){te(n,e,b),o(e,l),$(l,r[4]),o(e,a),o(e,s),o(s,t),i||(c=[W(l,"input",r[23]),W(s,"click",r[8])],i=!0)},p(n,b){b[0]&16&&l.value!==n[4]&&$(l,n[4])},d(n){n&&f(e),i=!1,Sl(c)}}}function js(r){let e,l,a,s,t,i;const c=[Ns,Cs],n=[];function b(p,k){return p[3]||!p[6]?0:1}return a=b(r),s=n[a]=c[a](r),{c(){e=h("div"),l=h("div"),s.c(),this.h()},l(p){e=_(p,"DIV",{class:!0});var k=d(e);l=_(k,"DIV",{class:!0});var m=d(l);s.l(m),m.forEach(f),k.forEach(f),this.h()},h(){u(l,"class","pop-up svelte-5rjid1"),u(e,"class",t=Tt(r[0]?"hidden":"overlay")+" svelte-5rjid1")},m(p,k){te(p,e,k),o(e,l),n[a].m(l,null),i=!0},p(p,k){let m=a;a=b(p),a===m?n[a].p(p,k):(qe(),F(n[m],1,1,()=>{n[m]=null}),He(),s=n[a],s?s.p(p,k):(s=n[a]=c[a](p),s.c()),O(s,1),s.m(l,null)),(!i||k[0]&1&&t!==(t=Tt(p[0]?"hidden":"overlay")+" svelte-5rjid1"))&&u(e,"class",t)},i(p){i||(O(s),i=!0)},o(p){F(s),i=!1},d(p){p&&f(e),n[a].d()}}}let ys=!1;function Ot(){return{title:"",authorName:"",authorSurname:"",editor:"",place:"",year:"",genre:"",comments:"",bookshelf:"",read:!1,loaned:!1}}function Ss(r,e,l){let a;jl(r,ot,I=>l(6,a=I));let{hidden:s=!0}=e,{length:t}=e,{update:i}=e,{scaffali:c}=e,{book:n=Ot()}=e,b=n.title?"Modifica":"Aggiungi",p=!1,k="",m=!1;function L(){l(2,n=Ot())}const g=()=>{const I=k.trim();I&&(l(1,c=new Set([...c,I])),l(4,k=""),l(5,m=!1),Ve("Nuovo scaffale aggiunto","success"))};async function Z(){var I,z,ce,se,ae,E,D;if(!n.isbn){Ve("Inserisci un ISBN valido","fail");return}l(3,p=!0);try{const le=(await(await fetch(`https://openlibrary.org/api/books?bibkeys=ISBN:${n.isbn}&format=json&jscmd=data`)).json())[`ISBN:${n.isbn}`];le?(l(2,n.title=le.title||"",n),l(2,n.authorName=((z=(I=le.authors)==null?void 0:I[0])==null?void 0:z.name.split(" ")[0])||"",n),l(2,n.authorSurname=((se=(ce=le.authors)==null?void 0:ce[0])==null?void 0:se.name.split(" ").slice(1).join(" "))||"",n),l(2,n.editor=((E=(ae=le.publishers)==null?void 0:ae[0])==null?void 0:E.name)||"",n),l(2,n.year=le.publish_date||"",n),l(2,n.cover=((D=le.cover)==null?void 0:D.large)||"",n)):Ve("Libro non trovato!","fail")}catch{Ve("Errore nel recupero dati","fail")}finally{l(3,p=!1)}}async function S(){l(3,p=!0);try{const I=n.id??t;await ss(`protectedData/${a}/${I}`,{...n,id:I}),Ve(`Libro ${b==="Aggiungi"?"aggiunto":"modificato"} con successo.`,"success"),l(12,i=!i),l(0,s=!0),L()}catch{Ve(`ERRORE: Il libro non è stato ${b==="Aggiungi"?"aggiunto":"modificato"} con successo.`,"fail")}finally{l(3,p=!1)}}function q(){l(0,s=!0),L()}function R(){n.isbn=this.value,l(2,n),l(1,c)}function X(){n.title=this.value,l(2,n),l(1,c)}function y(){n.authorName=this.value,l(2,n),l(1,c)}function A(){n.authorSurname=this.value,l(2,n),l(1,c)}function j(){n.editor=this.value,l(2,n),l(1,c)}function T(){n.place=this.value,l(2,n),l(1,c)}function K(){n.year=Qt(this.value),l(2,n),l(1,c)}function V(){n.genre=this.value,l(2,n),l(1,c)}function H(){n.bookshelf=Yt(this),l(2,n),l(1,c)}function G(){k=this.value,l(4,k)}const Y=()=>l(5,m=!0);function ee(){n.comments=this.value,l(2,n),l(1,c)}function ne(){n.cover=this.value,l(2,n),l(1,c)}function v(){n.read=this.checked,l(2,n),l(1,c)}function P(){n.loaned=this.checked,l(2,n),l(1,c)}return r.$$set=I=>{"hidden"in I&&l(0,s=I.hidden),"length"in I&&l(13,t=I.length),"update"in I&&l(12,i=I.update),"scaffali"in I&&l(1,c=I.scaffali),"book"in I&&l(2,n=I.book)},[s,c,n,p,k,m,a,b,g,Z,S,q,i,t,R,X,y,A,j,T,K,V,H,G,Y,ee,ne,v,P]}class As extends tl{constructor(e){super(),sl(this,e,Ss,js,al,{hidden:0,length:13,update:12,scaffali:1,book:2},null,[-1,-1])}}function ws(r){let e,l,a,s,t,i,c,n,b,p,k,m,L,g,Z,S,q,R,X,y,A,j,T,K,V,H,G,Y,ee;return{c(){e=h("div"),l=h("div"),a=h("ul"),s=h("li"),t=_e("svg"),i=_e("path"),c=C(),n=h("li"),b=_e("svg"),p=_e("path"),k=C(),m=h("li"),L=_e("svg"),g=_e("path"),Z=C(),S=h("li"),q=_e("svg"),R=_e("path"),X=C(),y=h("li"),A=_e("svg"),j=_e("path"),T=C(),K=h("li"),V=_e("svg"),H=_e("path"),G=C(),Y=h("span"),ee=M("Loading"),this.h()},l(ne){e=_(ne,"DIV",{class:!0});var v=d(e);l=_(v,"DIV",{class:!0});var P=d(l);a=_(P,"UL",{class:!0});var I=d(a);s=_(I,"LI",{class:!0});var z=d(s);t=de(z,"svg",{fill:!0,viewBox:!0,class:!0});var ce=d(t);i=de(ce,"path",{d:!0}),d(i).forEach(f),ce.forEach(f),z.forEach(f),c=N(I),n=_(I,"LI",{class:!0});var se=d(n);b=de(se,"svg",{fill:!0,viewBox:!0,class:!0});var ae=d(b);p=de(ae,"path",{d:!0}),d(p).forEach(f),ae.forEach(f),se.forEach(f),k=N(I),m=_(I,"LI",{class:!0});var E=d(m);L=de(E,"svg",{fill:!0,viewBox:!0,class:!0});var D=d(L);g=de(D,"path",{d:!0}),d(g).forEach(f),D.forEach(f),E.forEach(f),Z=N(I),S=_(I,"LI",{class:!0});var J=d(S);q=de(J,"svg",{fill:!0,viewBox:!0,class:!0});var x=d(q);R=de(x,"path",{d:!0}),d(R).forEach(f),x.forEach(f),J.forEach(f),X=N(I),y=_(I,"LI",{class:!0});var le=d(y);A=de(le,"svg",{fill:!0,viewBox:!0,class:!0});var oe=d(A);j=de(oe,"path",{d:!0}),d(j).forEach(f),oe.forEach(f),le.forEach(f),T=N(I),K=_(I,"LI",{class:!0});var pe=d(K);V=de(pe,"svg",{fill:!0,viewBox:!0,class:!0});var ie=d(V);H=de(ie,"path",{d:!0}),d(H).forEach(f),ie.forEach(f),pe.forEach(f),I.forEach(f),G=N(P),P.forEach(f),Y=_(v,"SPAN",{class:!0});var fe=d(Y);ee=U(fe,"Loading"),fe.forEach(f),v.forEach(f),this.h()},h(){u(i,"d","M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"),u(t,"fill","currentColor"),u(t,"viewBox","0 0 90 120"),u(t,"class","svelte-1lyp77k"),u(s,"class","svelte-1lyp77k"),u(p,"d","M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"),u(b,"fill","currentColor"),u(b,"viewBox","0 0 90 120"),u(b,"class","svelte-1lyp77k"),u(n,"class","svelte-1lyp77k"),u(g,"d","M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"),u(L,"fill","currentColor"),u(L,"viewBox","0 0 90 120"),u(L,"class","svelte-1lyp77k"),u(m,"class","svelte-1lyp77k"),u(R,"d","M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"),u(q,"fill","currentColor"),u(q,"viewBox","0 0 90 120"),u(q,"class","svelte-1lyp77k"),u(S,"class","svelte-1lyp77k"),u(j,"d","M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"),u(A,"fill","currentColor"),u(A,"viewBox","0 0 90 120"),u(A,"class","svelte-1lyp77k"),u(y,"class","svelte-1lyp77k"),u(H,"d","M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"),u(V,"fill","currentColor"),u(V,"viewBox","0 0 90 120"),u(V,"class","svelte-1lyp77k"),u(K,"class","svelte-1lyp77k"),u(a,"class","svelte-1lyp77k"),u(l,"class","svelte-1lyp77k"),u(Y,"class","svelte-1lyp77k"),u(e,"class","loader svelte-1lyp77k")},m(ne,v){te(ne,e,v),o(e,l),o(l,a),o(a,s),o(s,t),o(t,i),o(a,c),o(a,n),o(n,b),o(b,p),o(a,k),o(a,m),o(m,L),o(L,g),o(a,Z),o(a,S),o(S,q),o(q,R),o(a,X),o(a,y),o(y,A),o(A,j),o(a,T),o(a,K),o(K,V),o(V,H),o(l,G),o(e,Y),o(Y,ee)},p:Ne,i:Ne,o:Ne,d(ne){ne&&f(e)}}}class Ts extends tl{constructor(e){super(),sl(this,e,null,ws,al,{})}}const{Boolean:Ps}=ls;function Rt(r,e,l){const a=r.slice();return a[28]=e[l],a}function zt(r,e,l){const a=r.slice();return a[31]=e[l],a}function qt(r){let e,l,a,s,t;return l=new rs({props:{size:24}}),{c(){e=h("button"),be(l.$$.fragment),this.h()},l(i){e=_(i,"BUTTON",{class:!0,"aria-label":!0});var c=d(e);me(l.$$.fragment,c),c.forEach(f),this.h()},h(){u(e,"class","add-book-button svelte-41xi5l"),u(e,"aria-label","Add new book")},m(i,c){te(i,e,c),ge(l,e,null),a=!0,s||(t=W(e,"click",r[11]),s=!0)},p:Ne,i(i){a||(O(l.$$.fragment,i),a=!0)},o(i){F(l.$$.fragment,i),a=!1},d(i){i&&f(e),ke(l),s=!1,t()}}}function Ht(r){let e,l,a,s,t,i,c;function n(g){r[15](g)}function b(g){r[16](g)}function p(g){r[17](g)}function k(g){r[18](g)}function m(g){r[19](g)}let L={};return r[6]!==void 0&&(L.hidden=r[6]),r[7]!==void 0&&(L.book=r[7]),r[3].length!==void 0&&(L.length=r[3].length),r[0]!==void 0&&(L.update=r[0]),r[5]!==void 0&&(L.scaffali=r[5]),e=new As({props:L}),il.push(()=>ul(e,"hidden",n)),il.push(()=>ul(e,"book",b)),il.push(()=>ul(e,"length",p)),il.push(()=>ul(e,"update",k)),il.push(()=>ul(e,"scaffali",m)),{c(){be(e.$$.fragment)},l(g){me(e.$$.fragment,g)},m(g,Z){ge(e,g,Z),c=!0},p(g,Z){const S={};!l&&Z[0]&64&&(l=!0,S.hidden=g[6],cl(()=>l=!1)),!a&&Z[0]&128&&(a=!0,S.book=g[7],cl(()=>a=!1)),!s&&Z[0]&8&&(s=!0,S.length=g[3].length,cl(()=>s=!1)),!t&&Z[0]&1&&(t=!0,S.update=g[0],cl(()=>t=!1)),!i&&Z[0]&32&&(i=!0,S.scaffali=g[5],cl(()=>i=!1)),e.$set(S)},i(g){c||(O(e.$$.fragment,g),c=!0)},o(g){F(e.$$.fragment,g),c=!1},d(g){ke(e,g)}}}function Gt(r){let e,l=r[31]+"",a,s;return{c(){e=h("option"),a=M(l),this.h()},l(t){e=_(t,"OPTION",{});var i=d(e);a=U(i,l),i.forEach(f),this.h()},h(){e.__value=s=r[31],e.value=e.__value},m(t,i){te(t,e,i),o(e,a)},p(t,i){i[0]&32&&l!==(l=t[31]+"")&&Ge(a,l),i[0]&32&&s!==(s=t[31])&&(e.__value=s,e.value=e.__value)},d(t){t&&f(e)}}}function Ds(r){let e,l,a;return l=new Ts({}),{c(){e=h("div"),be(l.$$.fragment),this.h()},l(s){e=_(s,"DIV",{class:!0});var t=d(e);me(l.$$.fragment,t),t.forEach(f),this.h()},h(){u(e,"class","loader-container svelte-41xi5l")},m(s,t){te(s,e,t),ge(l,e,null),a=!0},p:Ne,i(s){a||(O(l.$$.fragment,s),a=!0)},o(s){F(l.$$.fragment,s),a=!1},d(s){s&&f(e),ke(l)}}}function Ms(r){let e,l,a,s;const t=[Vs,Us],i=[];function c(n,b){return n[9].length>0?0:1}return e=c(r),l=i[e]=t[e](r),{c(){l.c(),a=Pt()},l(n){l.l(n),a=Pt()},m(n,b){i[e].m(n,b),te(n,a,b),s=!0},p(n,b){let p=e;e=c(n),e===p?i[e].p(n,b):(qe(),F(i[p],1,1,()=>{i[p]=null}),He(),l=i[e],l?l.p(n,b):(l=i[e]=t[e](n),l.c()),O(l,1),l.m(a.parentNode,a))},i(n){s||(O(l),s=!0)},o(n){F(l),s=!1},d(n){i[e].d(n),n&&f(a)}}}function Us(r){let e,l,a,s,t,i,c,n,b;return l=new _s({props:{size:48}}),{c(){e=h("div"),be(l.$$.fragment),a=C(),s=h("p"),t=M("No books found"),i=C(),c=h("p"),n=M("Try adjusting your search or bookshelf filter"),this.h()},l(p){e=_(p,"DIV",{class:!0});var k=d(e);me(l.$$.fragment,k),a=N(k),s=_(k,"P",{});var m=d(s);t=U(m,"No books found"),m.forEach(f),i=N(k),c=_(k,"P",{class:!0});var L=d(c);n=U(L,"Try adjusting your search or bookshelf filter"),L.forEach(f),k.forEach(f),this.h()},h(){u(c,"class","empty-state-subtitle svelte-41xi5l"),u(e,"class","empty-state svelte-41xi5l")},m(p,k){te(p,e,k),ge(l,e,null),o(e,a),o(e,s),o(s,t),o(e,i),o(e,c),o(c,n),b=!0},p:Ne,i(p){b||(O(l.$$.fragment,p),b=!0)},o(p){F(l.$$.fragment,p),b=!1},d(p){p&&f(e),ke(l)}}}function Vs(r){let e,l,a=r[9].filter(Kt),s=[];for(let i=0;i<a.length;i+=1)s[i]=Jt(Rt(r,a,i));const t=i=>F(s[i],1,1,()=>{s[i]=null});return{c(){e=h("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=_(i,"DIV",{class:!0});var c=d(e);for(let n=0;n<s.length;n+=1)s[n].l(c);c.forEach(f),this.h()},h(){u(e,"class","book-grid svelte-41xi5l")},m(i,c){te(i,e,c);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null);l=!0},p(i,c){if(c[0]&13824){a=i[9].filter(Kt);let n;for(n=0;n<a.length;n+=1){const b=Rt(i,a,n);s[n]?(s[n].p(b,c),O(s[n],1)):(s[n]=Jt(b),s[n].c(),O(s[n],1),s[n].m(e,null))}for(qe(),n=a.length;n<s.length;n+=1)t(n);He()}},i(i){if(!l){for(let c=0;c<a.length;c+=1)O(s[c]);l=!0}},o(i){s=s.filter(Ps);for(let c=0;c<s.length;c+=1)F(s[c]);l=!1},d(i){i&&f(e),ht(s,i)}}}function Ft(r){let e,l,a,s=r[28].bookshelf+"",t,i;return l=new $t({props:{size:16}}),{c(){e=h("p"),be(l.$$.fragment),a=C(),t=M(s),this.h()},l(c){e=_(c,"P",{class:!0});var n=d(e);me(l.$$.fragment,n),a=N(n),t=U(n,s),n.forEach(f),this.h()},h(){u(e,"class","book-shelf svelte-41xi5l")},m(c,n){te(c,e,n),ge(l,e,null),o(e,a),o(e,t),i=!0},p(c,n){(!i||n[0]&512)&&s!==(s=c[28].bookshelf+"")&&Ge(t,s)},i(c){i||(O(l.$$.fragment,c),i=!0)},o(c){F(l.$$.fragment,c),i=!1},d(c){c&&f(e),ke(l)}}}function Xt(r){let e,l,a,s,t,i,c,n,b;function p(){return r[22](r[28])}function k(){return r[23](r[28])}return{c(){e=h("div"),l=h("button"),a=M("Modifica"),s=C(),t=h("button"),i=M("Rimuovi"),this.h()},l(m){e=_(m,"DIV",{class:!0});var L=d(e);l=_(L,"BUTTON",{class:!0});var g=d(l);a=U(g,"Modifica"),g.forEach(f),s=N(L),t=_(L,"BUTTON",{class:!0,"aria-label":!0});var Z=d(t);i=U(Z,"Rimuovi"),Z.forEach(f),L.forEach(f),this.h()},h(){u(l,"class","edit-button svelte-41xi5l"),u(t,"class","delete-button svelte-41xi5l"),u(t,"aria-label",c=`Remove ${r[28].title}`),u(e,"class","actions svelte-41xi5l")},m(m,L){te(m,e,L),o(e,l),o(l,a),o(e,s),o(e,t),o(t,i),n||(b=[W(l,"click",p),W(t,"click",k)],n=!0)},p(m,L){r=m,L[0]&512&&c!==(c=`Remove ${r[28].title}`)&&u(t,"aria-label",c)},d(m){m&&f(e),n=!1,Sl(b)}}}function Jt(r){let e,l,a,s,t,i,c,n,b=r[28].title+"",p,k,m,L,g=(r[28].authorName&&r[28].authorSurname?r[28].authorName.concat(" "+r[28].authorSurname):"Autore sconosciuto")+"",Z,S,q,R,X,y=r[28].bookshelf&&Ft(r),A=r[10]&&Xt(r);return{c(){e=h("article"),l=h("div"),a=h("img"),i=C(),c=h("div"),n=h("h2"),p=M(b),k=C(),m=h("p"),L=M("by "),Z=M(g),S=C(),y&&y.c(),q=C(),A&&A.c(),R=C(),this.h()},l(j){e=_(j,"ARTICLE",{class:!0});var T=d(e);l=_(T,"DIV",{class:!0});var K=d(l);a=_(K,"IMG",{class:!0,src:!0,alt:!0,loading:!0}),K.forEach(f),i=N(T),c=_(T,"DIV",{class:!0});var V=d(c);n=_(V,"H2",{class:!0});var H=d(n);p=U(H,b),H.forEach(f),k=N(V),m=_(V,"P",{class:!0});var G=d(m);L=U(G,"by "),Z=U(G,g),G.forEach(f),S=N(V),y&&y.l(V),V.forEach(f),q=N(T),A&&A.l(T),R=N(T),T.forEach(f),this.h()},h(){u(a,"class","book-cover svelte-41xi5l"),Dt(a.src,s=r[28].cover)||u(a,"src",s),u(a,"alt",t=`Cover of ${r[28].title}`),u(a,"loading","lazy"),u(l,"class","cover-container svelte-41xi5l"),u(n,"class","book-title svelte-41xi5l"),u(m,"class","book-author svelte-41xi5l"),u(c,"class","book-info svelte-41xi5l"),u(e,"class","book-card svelte-41xi5l")},m(j,T){te(j,e,T),o(e,l),o(l,a),o(e,i),o(e,c),o(c,n),o(n,p),o(c,k),o(c,m),o(m,L),o(m,Z),o(c,S),y&&y.m(c,null),o(e,q),A&&A.m(e,null),o(e,R),X=!0},p(j,T){(!X||T[0]&512&&!Dt(a.src,s=j[28].cover))&&u(a,"src",s),(!X||T[0]&512&&t!==(t=`Cover of ${j[28].title}`))&&u(a,"alt",t),(!X||T[0]&512)&&b!==(b=j[28].title+"")&&Ge(p,b),(!X||T[0]&512)&&g!==(g=(j[28].authorName&&j[28].authorSurname?j[28].authorName.concat(" "+j[28].authorSurname):"Autore sconosciuto")+"")&&Ge(Z,g),j[28].bookshelf?y?(y.p(j,T),T[0]&512&&O(y,1)):(y=Ft(j),y.c(),O(y,1),y.m(c,null)):y&&(qe(),F(y,1,1,()=>{y=null}),He()),j[10]?A?A.p(j,T):(A=Xt(j),A.c(),A.m(e,R)):A&&(A.d(1),A=null)},i(j){X||(O(y),X=!0)},o(j){F(y),X=!1},d(j){j&&f(e),y&&y.d(),A&&A.d()}}}function Zs(r){let e,l,a,s,t,i,c,n,b=r[4].replace("_"," ")+"",p,k,m,L,g,Z,S,q,R,X,y,A,j,T,K,V,H,G,Y,ee,ne,v=r[10]&&qt(r),P=!r[6]&&Ht(r);g=new $t({props:{size:20}});let I=[...r[5]],z=[];for(let E=0;E<I.length;E+=1)z[E]=Gt(zt(r,I,E));A=new Es({props:{size:20}});const ce=[Ms,Ds],se=[];function ae(E,D){return E[8]?1:0}return H=ae(r),G=se[H]=ce[H](r),{c(){v&&v.c(),e=C(),l=h("main"),P&&P.c(),a=C(),s=h("div"),t=h("h1"),i=M("Biblioteca:"),c=C(),n=h("h1"),p=M(b),k=C(),m=h("div"),L=h("div"),be(g.$$.fragment),Z=C(),S=h("select"),q=h("option"),R=M("All Bookshelves");for(let E=0;E<z.length;E+=1)z[E].c();X=C(),y=h("div"),be(A.$$.fragment),j=C(),T=h("input"),K=C(),V=h("div"),G.c(),this.h()},l(E){v&&v.l(E),e=N(E),l=_(E,"MAIN",{class:!0});var D=d(l);P&&P.l(D),a=N(D),s=_(D,"DIV",{class:!0});var J=d(s);t=_(J,"H1",{class:!0});var x=d(t);i=U(x,"Biblioteca:"),x.forEach(f),c=N(J),n=_(J,"H1",{class:!0});var le=d(n);p=U(le,b),le.forEach(f),k=N(J),m=_(J,"DIV",{class:!0});var oe=d(m);L=_(oe,"DIV",{class:!0});var pe=d(L);me(g.$$.fragment,pe),Z=N(pe),S=_(pe,"SELECT",{"aria-label":!0,class:!0});var ie=d(S);q=_(ie,"OPTION",{});var fe=d(q);R=U(fe,"All Bookshelves"),fe.forEach(f);for(let ue=0;ue<z.length;ue+=1)z[ue].l(ie);ie.forEach(f),pe.forEach(f),X=N(oe),y=_(oe,"DIV",{class:!0});var ye=d(y);me(A.$$.fragment,ye),j=N(ye),T=_(ye,"INPUT",{type:!0,placeholder:!0,"aria-label":!0,class:!0}),ye.forEach(f),oe.forEach(f),J.forEach(f),K=N(D),V=_(D,"DIV",{class:!0});var Fe=d(V);G.l(Fe),Fe.forEach(f),D.forEach(f),this.h()},h(){u(t,"class","page-title svelte-41xi5l"),u(n,"class","lib-title"),q.__value="all",q.value=q.__value,u(S,"aria-label","Filter by bookshelf"),u(S,"class","svelte-41xi5l"),r[1]===void 0&&Wt(()=>r[20].call(S)),u(L,"class","bookshelf-filter svelte-41xi5l"),u(T,"type","text"),u(T,"placeholder","Cerca libri..."),u(T,"aria-label","Search books"),u(T,"class","svelte-41xi5l"),u(y,"class","search-bar svelte-41xi5l"),u(m,"class","filters svelte-41xi5l"),u(s,"class","top-actions svelte-41xi5l"),u(V,"class","book-grid-container svelte-41xi5l"),u(l,"class","content svelte-41xi5l")},m(E,D){v&&v.m(E,D),te(E,e,D),te(E,l,D),P&&P.m(l,null),o(l,a),o(l,s),o(s,t),o(t,i),o(s,c),o(s,n),o(n,p),o(s,k),o(s,m),o(m,L),ge(g,L,null),o(L,Z),o(L,S),o(S,q),o(q,R);for(let J=0;J<z.length;J+=1)z[J]&&z[J].m(S,null);yl(S,r[1],!0),o(m,X),o(m,y),ge(A,y,null),o(y,j),o(y,T),$(T,r[2]),o(l,K),o(l,V),se[H].m(V,null),Y=!0,ee||(ne=[W(S,"change",r[20]),W(T,"input",r[21])],ee=!0)},p(E,D){if(E[10]?v?(v.p(E,D),D[0]&1024&&O(v,1)):(v=qt(E),v.c(),O(v,1),v.m(e.parentNode,e)):v&&(qe(),F(v,1,1,()=>{v=null}),He()),E[6]?P&&(qe(),F(P,1,1,()=>{P=null}),He()):P?(P.p(E,D),D[0]&64&&O(P,1)):(P=Ht(E),P.c(),O(P,1),P.m(l,a)),(!Y||D[0]&16)&&b!==(b=E[4].replace("_"," ")+"")&&Ge(p,b),D[0]&32){I=[...E[5]];let x;for(x=0;x<I.length;x+=1){const le=zt(E,I,x);z[x]?z[x].p(le,D):(z[x]=Gt(le),z[x].c(),z[x].m(S,null))}for(;x<z.length;x+=1)z[x].d(1);z.length=I.length}D[0]&34&&yl(S,E[1]),D[0]&4&&T.value!==E[2]&&$(T,E[2]);let J=H;H=ae(E),H===J?se[H].p(E,D):(qe(),F(se[J],1,1,()=>{se[J]=null}),He(),G=se[H],G?G.p(E,D):(G=se[H]=ce[H](E),G.c()),O(G,1),G.m(V,null))},i(E){Y||(O(v),O(P),O(g.$$.fragment,E),O(A.$$.fragment,E),O(G),Y=!0)},o(E){F(v),F(P),F(g.$$.fragment,E),F(A.$$.fragment,E),F(G),Y=!1},d(E){v&&v.d(E),E&&f(e),E&&f(l),P&&P.d(),ke(g),ht(z,E),ke(A),se[H].d(),ee=!1,Sl(ne)}}}const Kt=(r,e)=>e!==0;function Os(r,e,l){let a,s,t;jl(r,ot,v=>l(4,a=v)),jl(r,Ut,v=>l(14,s=v)),jl(r,is,v=>l(25,t=v)),xt(async()=>{ns.set(!1),Ut.set(await as(t.uid).then(v=>l(10,S=v))),Z=t.photoURL??"/profile_placeholder.png",await Mt(`users/${t.uid}/biblioteca`).then(async v=>{console.log("userLib:",v),es(ot,a=v,a),await R(v)})});let i=!1,c=new Set,n="all",b=!0,p,k=!0,m="",L=[],g=[],Z,S;const q=v=>{l(7,p=v),l(6,b=!b)},R=async v=>{l(8,k=!0),await Mt(`protectedData/${v}`).then(P=>{l(3,L=P),l(5,c=new Set(P.map(I=>I.bookshelf).filter(Boolean))),l(9,g=P),l(8,k=!1)})},X=()=>{l(6,b=!b)},y=v=>{q(v)},A=async v=>{try{l(8,k=!0),await os(`protectedData/${a}/${v.id}`),await R(a),Ve("Book removed successfully","success")}catch(P){Ve("Failed to remove book","error"),console.error(P)}finally{l(8,k=!1)}};function j(v){b=v,l(6,b)}function T(v){p=v,l(7,p)}function K(v){r.$$.not_equal(L.length,v)&&(L.length=v,l(3,L))}function V(v){i=v,l(0,i),l(4,a)}function H(v){c=v,l(5,c)}function G(){n=Yt(this),l(1,n),l(5,c)}function Y(){m=this.value,l(2,m)}const ee=v=>y(v),ne=v=>A(v);return r.$$.update=()=>{r.$$.dirty[0]&16384&&l(10,S=s),r.$$.dirty[0]&14&&l(9,g=L.filter(v=>{const P=m.trim()===""||v.title.toLowerCase().includes(m.toLowerCase()),I=n==="all"||v.bookshelf===n;return P&&I})),r.$$.dirty[0]&17&&(a&&R(a),i&&(R(a),l(0,i=!1)))},[i,n,m,L,a,c,b,p,k,g,S,X,y,A,s,j,T,K,V,H,G,Y,ee,ne]}class Xs extends tl{constructor(e){super(),sl(this,e,Os,Zs,al,{},null,[-1,-1])}}export{Xs as component};
